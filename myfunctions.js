function CompareFunc(a,b){
	return a-b;
}//end CompareFunc

function SitchToPitch(sitch){
	var p_rel,p;
	if(sitch[0]=='C'){p_rel=60;
	}else if(sitch[0]=='D'){p_rel=62;
	}else if(sitch[0]=='E'){p_rel=64;
	}else if(sitch[0]=='F'){p_rel=65;
	}else if(sitch[0]=='G'){p_rel=67;
	}else if(sitch[0]=='A'){p_rel=69;
	}else if(sitch[0]=='B'){p_rel=71;
	}//endif
	sitch=sitch.slice(1);
	var oct=Number(sitch[sitch.length-1]);
	sitch=sitch.slice(0,sitch.length-1);
	p=p_rel+(oct-4)*12;
	if(sitch==""){p+=0;
	}else if(sitch=="#"){p+=1;
	}else if(sitch=="##"){p+=2;
	}else if(sitch=="b"){p-=1;
	}else if(sitch=="bb"){p-=2;
	}else if(sitch=="+"){p+=1;
	}else if(sitch=="++"){p+=2;
	}else if(sitch=="-"){p-=1;
	}else if(sitch=="--"){p-=2;
	}//endif
	return p;
}//end SitchToPitch

function SitchToSitchHeight(sitch){
	var oct=Number(sitch[sitch.length-1]);
	var ht;
	if(sitch[0]=='C'){ht=0;
	}else if(sitch[0]=='D'){ht=1;
	}else if(sitch[0]=='E'){ht=2;
	}else if(sitch[0]=='F'){ht=3;
	}else if(sitch[0]=='G'){ht=4;
	}else if(sitch[0]=='A'){ht=5;
	}else if(sitch[0]=='B'){ht=6;
	}else{ht=0;
	}//endif
	return ht+7*(oct-4);
}//end SitchToSitchHeight

function SitchToAcc(sitch){
	var accLab=sitch.slice(1,sitch.length-1);
	if(accLab==""){return 0;
	}else if(accLab=="#"){return 1;
	}else if(accLab=="##"){return 2;
	}else if(accLab=="b"){return -1;
	}else if(accLab=="bb"){return -2;
	}else if(accLab=="+"){return 1;
	}else if(accLab=="++"){return 2;
	}else if(accLab=="-"){return -1;
	}else if(accLab=="--"){return -2;
	}else{return 0;
	}//endif
}//end SitchToAcc

class PianoRollEvt{
	constructor(){
		this.ID=-1;
		this.ontime=-1;
		this.offtime=-1;
		this.sitch="NA";
		this.pitch=-1;
		this.onvel=80;
		this.offvel=80;
		this.channel=0;
		this.endtime=-1;
		this.label="";
		this.ext1=-1;
	}//end constructor

	FromSprEvt(evt){
		this.ID=Number(evt[0]);
		this.ontime=Number(evt[1]);
		this.offtime=Number(evt[2]);
		this.sitch=evt[3];
		this.pitch=SitchToPitch(evt[3]);
		this.onvel=Number(evt[4]);
		this.offvel=Number(evt[5]);
		this.channel=Number(evt[6]);
		this.endtime=-1;
		this.label="";
		this.ext1=-1;
	}//end FromSprEvt
}//endclass PianoRollEvt

function FingerNumToInt(fingerNum){
	if(fingerNum[0]=='-'){
		if(fingerNum[1]=='1'){return -1;
		}else if(fingerNum[1]=='2'){return -2;
		}else if(fingerNum[1]=='3'){return -3;
		}else if(fingerNum[1]=='4'){return -4;
		}else if(fingerNum[1]=='5'){return -5;
		}else{return 0;
		}//endif
	}else{
		if(fingerNum[0]=='1'){return 1;
		}else if(fingerNum[0]=='2'){return 2;
		}else if(fingerNum[0]=='3'){return 3;
		}else if(fingerNum[0]=='4'){return 4;
		}else if(fingerNum[0]=='5'){return 5;
		}else{return 0;
		}//endif
	}//endif
}//end FingerNumToInt

class FingeringEvt{
	constructor(){
		this.ID=-1;
		this.ontime=-1;
		this.offtime=-1;
		this.sitch="NA";
		this.pitch=-1;
		this.onvel=80;
		this.offvel=80;
		this.channel=0;
		this.fingerNum="";
		this.finger=-1;
		this.fingerRep="";
		this.endtime=-1;
		this.label="";
		this.ext1=-1;
	}//end constructor

	FromFileEvt(evt){
		this.ID=Number(evt[0]);
		this.ontime=Number(evt[1]);
		this.offtime=Number(evt[2]);
		this.sitch=evt[3];
		this.pitch=SitchToPitch(evt[3]);
		this.onvel=Number(evt[4]);
		this.offvel=Number(evt[5]);
		this.channel=Number(evt[6]);
		if(evt.length<8){
			this.fingerNum='0';
			this.finger=0;
			this.fingerRep='0';
		}else{
			this.fingerNum=evt[7];
			this.finger=FingerNumToInt(evt[7]);
			this.fingerRep=((evt[7][0]=='-')? evt[7].slice(1):evt[7]);
//			this.fingerRep=evt[7].replace('-','');
		}//endif
		this.endtime=-1;
		this.label="";
		this.ext1=-1;
	}//end FromSprEvt
}//endclass FingeringEvt

function Norm(vd){
	var sum=0;
	for(var i=0,len=vd.length;i<len;i+=1){
		sum+=vd[i];
	}//endfor i
	for(var i=0,len=vd.length;i<len;i+=1){
		vd[i]/=sum;
	}//endfor i
	return vd;
}//end Norm

function Lognorm(vd){
	var tmpd=vd[0];
	for(var i=0,len=vd.length;i<len;i+=1){
		if(vd[i]>tmpd){tmpd=vd[i];}
	}//endfor i
	for(var i=0,len=vd.length;i<len;i+=1){vd[i]-=tmpd;}//endfor i
	tmpd=0;
	for(var i=0,len=vd.length;i<len;i+=1){tmpd+=Math.exp(vd[i]);}//endfor i
	tmpd=Math.log(tmpd);
	for(var i=0,len=vd.length;i<len;i+=1){
		vd[i]-=tmpd;
		if(vd[i]<-200){vd[i]=-200;}
	}//endfor i
	return vd;
}//end Lognorm

class Prob{
// 	constructor(){
// 		this.P=[];
// 		this.LP=[];
// 	}//end constructor

	constructor(_size=1){
		this.P=[];
		this.LP=[];
		this.Resize(_size);
	}//end constructor

	Resize(_size){
		this.P=[]; this.LP=[];
		this.P=new Array(_size);
		this.LP=new Array(_size);
		return;
	}//end Resize

	Assign(_size,value){
		this.P=[]; this.LP=[];
		for(var i=0;i<_size;i+=1){
			this.P.push(value);
		}//endfor i
		this.LP=new Array(_size);
	}//end Assign

	PToLP(){
		this.LP=[];
		this.LP=new Array(this.P.length);
		for(var i=0,len=this.P.length;i<len;i+=1){
			this.LP[i]=Math.log(this.P[i]);
		}//endfor i
	}//end PToLP

	LPToP(){
		this.P=[];
		this.P=new Array(this.LP.length);
		for(var i=0,len=this.LP.length;i<len;i+=1){
			this.P[i]=Math.exp(this.LP[i]);
		}//endfor i
	}//end LPToP

	Normalize(){
		this.P=Norm(this.P);
		this.PToLP();
	}//end Normalize

	LogNormalize(){
		this.LP=Lognorm(this.LP);
		this.LPToP();
	}//end Normalize

}//endclass Prob

class KeyPos{
	constructor(pitch=60){
		var pc=pitch%12;
		var oct=Math.floor(pitch/12)-1;
		if(pc==0||pc==1){this.x=0;
		}else if(pc==2||pc==3){this.x=1;
		}else if(pc==4){this.x=2;
		}else if(pc==5||pc==6){this.x=3;
		}else if(pc==7||pc==8){this.x=4;
		}else if(pc==9||pc==10){this.x=5;
		}else if(pc==11){this.x=6;
		}//endif
		this.x+=7*(oct-4);
		if(pc==0||pc==2||pc==4||pc==5||pc==7||pc==9||pc==11){this.y=0;
		}else if(pc==1||pc==3||pc==6||pc==8||pc==10){this.y=1;
		}//endif
	}//end constructor

};//endclass KeyPos


function SubtrKeyPos(kp1,kp2){//KeyPos kp1, KeyPos kp2
// interval from kp2 to kp1
	var keyPos=new KeyPos();
	keyPos.x=kp1.x-kp2.x;
	keyPos.y=kp1.y-kp2.y;
	return keyPos;
}//end SubtrKeyPos




class FHMM1{

	constructor(){
		this.iniProb=new Array(2);//[0,1]=Right,Left 0,...,4 <-> finger 1,...,5
		this.trProb=new Array(2);//[0,1]=Right,Left x 5 x 5
		this.outProb=new Array(2);//[0,1]=Right,Left x 5 x 5 x ((2*widthX+1)*3), dkey%3=dY+1, dkey/3=dX+widthX, dkey=3*(dX+widthX)+dY+1
		this.widthX=15;//15 <-> -inf=-15,-14,...,0,...,14,15=inf (dim = 2*widthX + 1) [dx+widthX]
		this.nOut=3*(2*this.widthX+1);
		this.w1=1;//weights for the output probabilities
		this.shortTimeCost=-5;
		this.fin=[];//fingering data

		for(var h=0;h<2;h+=1){
			this.iniProb[h]=new Prob(5);
			this.trProb[h]=new Array(5);
			this.outProb[h]=new Array(5);
			for(var i=0;i<5;i+=1){
				this.trProb[h][i]=new Prob(5);
				this.outProb[h][i]=new Array(5);
				for(var ip=0;ip<5;ip+=1){
					this.outProb[h][i][ip]=new Prob(this.nOut);
				}//endfor ip
			}//endfor i
		}//endfor h
		this.Init();
	}//end constructor

	Init(){

		this.iniProb[0].P=[0.39622,0.169812,0.18239,0.094343,0.157234];
		this.iniProb[1].P=[0.106921,0.11321,0.0943429,0.0817647,0.603761];
		this.trProb[0][0].P=[0.0337035,0.397171,0.198123,0.150674,0.220328];
		this.trProb[0][1].P=[0.317849,0.0170221,0.273942,0.225422,0.165765];
		this.trProb[0][2].P=[0.277559,0.329458,0.0244968,0.131202,0.237285];
		this.trProb[0][3].P=[0.384084,0.16914,0.242835,0.0150975,0.188843];
		this.trProb[0][4].P=[0.524839,0.198501,0.112848,0.143469,0.0203428];
		this.trProb[1][0].P=[0.0311415,0.283748,0.125678,0.135688,0.423745];
		this.trProb[1][1].P=[0.564123,0.0263574,0.182533,0.0812355,0.145751];
		this.trProb[1][2].P=[0.412022,0.341265,0.0115845,0.108641,0.126487];
		this.trProb[1][3].P=[0.332893,0.378188,0.175022,0.00747624,0.106421];
		this.trProb[1][4].P=[0.445127,0.203178,0.19661,0.108898,0.0461866];
		this.outProb[0][0][0].P=[3.92014e-06,3.92014e-06,0.0117643,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,0.00392406,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,0.00392406,0.00392406,3.92014e-06,3.92014e-06,0.00392406,3.92014e-06,3.92014e-06,0.0156845,3.92014e-06,3.92014e-06,0.0235248,3.92014e-06,3.92014e-06,0.0509657,0.0117643,0.0078442,0.0196046,0.00392406,3.92014e-06,0.0117643,0.00392406,0.0117643,0.0117643,0.0352852,0.0156845,0.0784067,0.0117643,0.0274449,0.313615,0.0392053,0.0274449,0.0744866,0.0235248,0.0117643,0.0274449,0.0156845,0.00392406,0.0235248,3.92014e-06,3.92014e-06,0.00392406,0.0117643,0.00392406,3.92014e-06,3.92014e-06,3.92014e-06,0.00392406,3.92014e-06,3.92014e-06,0.0274449,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,0.00392406,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06,0.0156845,3.92014e-06,3.92014e-06,3.92014e-06,3.92014e-06];
		this.outProb[0][0][1].P=[3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,0.000333101,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,0.000333101,0.00133141,0.000998639,0.000333101,0.00066587,0.00133141,0.000333101,3.32768e-07,3.32768e-07,0.00299525,0.000998639,3.32768e-07,0.000998639,0.0066557,0.000998639,0.016306,0.030615,0.00232971,0.0196337,0.0455896,0.00798677,0.133108,0.0898479,0.0695489,0.189678,0.0871857,0.0715455,0.120462,0.0143094,0.0106489,0.0442585,0.00133141,0.00465909,0.0106489,0.00266248,0.00299525,0.000998639,0.000333101,3.32768e-07,0.00266248,0.000333101,3.32768e-07,3.32768e-07,0.00066587,0.000333101,0.000333101,3.32768e-07,3.32768e-07,0.000333101,3.32768e-07,3.32768e-07,3.32768e-07,0.000333101,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07,3.32768e-07];
		this.outProb[0][0][2].P=[6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,0.000667737,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,0.000667737,0.000667737,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,0.00133481,6.6707e-07,6.6707e-07,0.0113409,0.0200128,0.00133481,0.0393578,0.0346883,0.00133481,0.022681,0.0140091,0.00133481,0.03202,0.0526992,0.0213469,0.146089,0.0847186,0.0526992,0.157429,0.0266835,0.0273505,0.1094,0.0286847,0.0213469,0.0426931,0.0173445,0.0106738,0.00667137,0.00333602,0.00333602,0.00266895,6.6707e-07,6.6707e-07,6.6707e-07,0.000667737,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,0.000667737,6.6707e-07,6.6707e-07,0.000667737,6.6707e-07,6.6707e-07,0.000667737,6.6707e-07,6.6707e-07,0.000667737,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07,6.6707e-07];
		this.outProb[0][0][3].P=[8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,0.00175512,0.00350936,8.7712e-07,0.00350936,0.0114035,8.7712e-07,0.0166662,0.00789497,8.7712e-07,0.00175512,0.0245603,0.00175512,0.0289459,0.00614073,0.0105263,0.0394713,0.0385942,0.00350936,0.0842045,0.0429798,0.022806,0.106133,0.0824503,0.0473654,0.0850817,0.0622765,0.0421027,0.0456112,0.0192975,0.0096492,0.128938,0.00175512,0.00350936,0.00175512,0.00175512,0.000877998,0.00526361,8.7712e-07,8.7712e-07,0.00175512,0.00175512,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,0.00175512,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07,0.000877998,8.7712e-07,8.7712e-07,8.7712e-07,8.7712e-07];
		this.outProb[0][0][4].P=[5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,0.000600446,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,0.00120029,5.99847e-07,5.99847e-07,5.99847e-07,0.00120029,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,0.00180014,0.000600446,5.99847e-07,0.000600446,5.99847e-07,0.00120029,0.00239999,0.00239999,5.99847e-07,0.0287932,0.00359968,0.00419953,0.056986,0.0551865,0.0383908,0.102574,0.0305928,0.0353915,0.0563862,0.0107978,0.0089983,0.469081,0.0149968,0.010198,0.0131972,0.00479937,0.00539922,0.00719876,0.00299983,0.00299983,0.00839845,0.000600446,0.000600446,0.00419953,0.00239999,0.00120029,0.00180014,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,5.99847e-07,0.00359968,5.99847e-07,0.000600446,0.00120029,0.000600446];
		this.outProb[0][1][0].P=[5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,0.00100145,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,0.000500978,5.00477e-07,0.000500978,5.00477e-07,0.00250289,0.000500978,5.00477e-07,0.000500978,0.00100145,0.00150193,0.00100145,0.00300336,0.00350384,0.0240234,0.00600623,0.00700718,0.0930892,0.0575554,0.0450434,0.124119,0.0535516,0.100596,0.21921,0.021521,0.108104,0.022522,0.00300336,0.0480463,0.0125124,0.00100145,0.0155153,0.00500527,0.00100145,0.00800813,0.00300336,5.00477e-07,0.000500978,5.00477e-07,5.00477e-07,0.00150193,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,0.00250289,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,0.000500978,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07,5.00477e-07];
		this.outProb[0][1][1].P=[9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,0.00934702,0.00934702,9.33768e-06,0.00934702,0.0186847,9.33768e-06,0.00934702,0.00934702,0.0280224,0.00934702,0.0373601,0.0186847,0.606958,0.00934702,0.0186847,0.0280224,0.0186847,0.00934702,0.0373601,0.00934702,0.0186847,0.00934702,9.33768e-06,9.33768e-06,0.0186847,0.00934702,9.33768e-06,9.33768e-06,9.33768e-06,0.00934702,9.33768e-06,9.33768e-06,9.33768e-06,0.0186847,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,0.0186847,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06,9.33768e-06];
		this.outProb[0][1][2].P=[5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,0.000581269,0.00232334,5.80689e-07,0.000581269,0.000581269,0.00290402,0.00116196,0.000581269,5.80689e-07,0.0150985,0.139947,0.0836198,0.238664,0.111493,0.129494,0.1684,0.0313578,0.0377453,0.0238088,0.00116196,0.00116196,0.00696885,0.00116196,5.80689e-07,5.80689e-07,5.80689e-07,0.000581269,0.000581269,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07,5.80689e-07];
		this.outProb[0][1][3].P=[7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,0.000706377,0.00141205,0.000706377,0.00282339,0.00635175,0.00282339,0.00141205,0.00776309,0.0691565,0.114319,0.268155,0.121376,0.0797415,0.229343,0.0190538,0.0254048,0.0303445,0.00282339,0.00635175,0.0049404,0.00141205,7.05671e-07,7.05671e-07,0.00141205,7.05671e-07,0.000706377,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,0.00141205,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07,7.05671e-07];
		this.outProb[0][1][4].P=[9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,0.000960567,9.59607e-07,9.59607e-07,0.00287978,9.59607e-07,9.59607e-07,0.00383939,0.00192017,0.0163143,0.0143951,0.0191931,0.0374256,0.226468,0.02687,0.0460621,0.166013,0.0422237,0.118033,0.129548,0.036466,0.063335,0.0105566,0.00383939,0.00383939,0.0191931,9.59607e-07,9.59607e-07,0.000960567,9.59607e-07,9.59607e-07,0.00192017,0.000960567,0.000960567,0.004799,9.59607e-07,0.000960567,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07,9.59607e-07];
		this.outProb[0][2][0].P=[7.47891e-07,0.000748639,0.000748639,7.47891e-07,0.000748639,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,0.000748639,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,0.000748639,7.47891e-07,0.000748639,0.000748639,0.0127149,0.00299231,0.00149653,0.011967,0.0172022,0.0149586,0.039639,0.0373953,0.0373953,0.121907,0.0164544,0.0426305,0.185478,0.0403869,0.059832,0.125646,0.011967,0.0605799,0.0291685,0.00149653,0.0172022,0.00972333,0.00299231,0.0321601,0.0172022,0.0037402,0.0157065,0.00747966,0.00149653,0.00149653,0.011967,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,0.00149653,7.47891e-07,7.47891e-07,7.47891e-07,0.000748639,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07,7.47891e-07];
		this.outProb[0][2][1].P=[6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,0.000630714,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,0.000630714,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,0.000630714,6.30084e-07,6.30084e-07,6.30084e-07,0.000630714,6.30084e-07,0.000630714,0.000630714,0.0012608,0.00378113,0.010712,0.0050413,0.0151226,0.0157527,0.0170129,0.0699399,0.136099,0.104594,0.294879,0.120346,0.172643,0.0189031,0.000630714,0.0012608,0.00189088,0.0012608,0.000630714,0.00189088,6.30084e-07,6.30084e-07,0.000630714,6.30084e-07,0.000630714,6.30084e-07,0.000630714,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,0.000630714,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07,6.30084e-07];
		this.outProb[0][2][2].P=[8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,0.0169443,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,0.00847636,8.46789e-06,8.46789e-06,8.46789e-06,0.0508159,0.0169443,0.0169443,8.46789e-06,0.0169443,8.46789e-06,0.0254122,0.0338801,8.46789e-06,0.0254122,0.499615,8.46789e-06,0.0169443,0.0508159,0.0508159,0.0169443,8.46789e-06,0.00847636,8.46789e-06,0.0592838,0.00847636,8.46789e-06,0.042348,8.46789e-06,8.46789e-06,0.00847636,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,0.0254122,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06,8.46789e-06];
		this.outProb[0][2][3].P=[1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,0.00316567,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,0.00632975,0.00158363,1.58205e-06,1.58205e-06,1.58205e-06,0.0268964,0.110745,0.148714,0.412916,0.0791038,0.115491,0.0553731,0.0079118,0.00632975,0.00949385,0.00158363,0.00158363,0.00474772,1.58205e-06,1.58205e-06,0.00316567,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,0.00316567,0.00158363,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06,1.58205e-06];
		this.outProb[0][2][4].P=[8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,0.000875694,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,0.000875694,8.74819e-07,0.000875694,8.74819e-07,8.74819e-07,0.00175051,0.00437497,0.00175051,0.00787425,0.00962389,0.0708613,0.102355,0.275569,0.111978,0.139097,0.173215,0.0218714,0.0122483,0.0288699,0.00524979,0.00874907,0.00962389,0.00175051,0.00350015,0.00350015,0.000875694,8.74819e-07,0.000875694,8.74819e-07,8.74819e-07,0.000875694,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,0.000875694,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07,8.74819e-07];
		this.outProb[0][3][0].P=[0.00133303,0.00199921,6.66181e-07,6.66181e-07,0.00133303,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,0.000666847,0.000666847,0.00133303,0.00133303,6.66181e-07,6.66181e-07,0.00266539,0.00133303,0.00333157,0.00133303,0.00199921,0.00866102,0.0119919,6.66181e-07,0.0059963,0.0626217,0.00466393,0.0173214,0.0679512,0.0253156,0.0719482,0.12391,0.0659526,0.0679512,0.139233,0.0313112,0.0499643,0.0959308,0.00866102,0.0173214,0.0213185,0.00466393,0.00466393,0.0219846,0.00266539,0.00533012,0.00333157,6.66181e-07,0.0113257,0.0059963,6.66181e-07,0.0093272,0.00466393,0.000666847,0.00199921,6.66181e-07,6.66181e-07,6.66181e-07,0.00133303,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,0.000666847,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,0.00199921,0.000666847,6.66181e-07,0.00133303,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07,6.66181e-07];
		this.outProb[0][3][1].P=[1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,0.00302681,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,0.00151416,1.51265e-06,1.51265e-06,0.0060521,1.51265e-06,0.00151416,1.51265e-06,1.51265e-06,1.51265e-06,0.00151416,1.51265e-06,1.51265e-06,1.51265e-06,0.00756475,0.00302681,1.51265e-06,0.00151416,0.00151416,0.00302681,0.00302681,0.00151416,0.01059,0.0499188,0.0181533,0.0211786,0.213285,0.110425,0.0937856,0.19362,0.0907603,0.0952982,0.0226912,0.00151416,0.00907739,0.00907739,1.51265e-06,1.51265e-06,0.00453945,0.00453945,0.00151416,0.00453945,1.51265e-06,1.51265e-06,0.00151416,1.51265e-06,1.51265e-06,0.00151416,0.00302681,1.51265e-06,1.51265e-06,1.51265e-06,0.00151416,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,0.00302681,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06,1.51265e-06];
		this.outProb[0][3][2].P=[1.05364e-06,0.00105469,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,0.00105469,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,0.00105469,1.05364e-06,0.00210833,1.05364e-06,1.05364e-06,0.00632288,1.05364e-06,1.05364e-06,0.0042156,0.0105374,0.00843015,0.0168593,0.113794,0.0748093,0.425671,0.152778,0.141188,0.0200202,0.0042156,0.00105469,1.05364e-06,0.00948379,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,0.00105469,1.05364e-06,1.05364e-06,0.00105469,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,0.00210833,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,0.00105469,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06,1.05364e-06];
		this.outProb[0][3][3].P=[1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,0.0169394,0.0169394,0.0169394,0.0169394,0.0169394,0.0338619,0.0677068,0.0677068,0.541536,1.69225e-05,0.0169394,0.0338619,0.0169394,0.0169394,1.69225e-05,1.69225e-05,1.69225e-05,0.0338619,0.0338619,1.69225e-05,0.0169394,1.69225e-05,1.69225e-05,0.0169394,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,0.0169394,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05,1.69225e-05];
		this.outProb[0][3][4].P=[1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,0.0013562,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,0.00406588,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,0.0013562,1.35484e-06,0.00948525,1.35484e-06,0.00813041,0.0216788,0.0596144,0.123292,0.340067,0.0826468,0.101615,0.165292,0.0365821,0.0121949,0.0162595,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,0.0013562,0.00271104,1.35484e-06,1.35484e-06,0.00406588,1.35484e-06,1.35484e-06,0.00271104,1.35484e-06,1.35484e-06,0.0013562,1.35484e-06,1.35484e-06,0.0013562,1.35484e-06,1.35484e-06,0.0013562,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,0.0013562,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06,1.35484e-06];
		this.outProb[0][4][0].P=[0.00081637,0.00326426,0.000408389,4.07981e-07,0.00326426,0.000408389,4.07981e-07,0.00122435,0.00081637,4.07981e-07,0.00326426,0.0024483,0.00530416,0.0106079,0.00081637,0.00081637,0.0183596,0.00693609,0.00530416,0.0216234,0.0167276,0.0110159,0.0538539,0.0232553,0.0228474,0.265596,0.0244793,0.0346788,0.0844525,0.0505901,0.029783,0.101996,0.0354948,0.0403906,0.0558938,0.00285628,0.0044882,0.0146877,0.00367224,0.00326426,0.00612013,0.00204031,0.00122435,0.0024483,0.00081637,0.00081637,0.0106079,0.000408389,0.00204031,0.00122435,0.00122435,0.00122435,0.0024483,0.000408389,0.000408389,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,0.00081637,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07,4.07981e-07];
		this.outProb[0][4][1].P=[1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,0.00107972,0.00215836,0.00107972,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,0.00215836,1.07864e-06,0.003237,1.07864e-06,0.00431564,0.00215836,0.00107972,0.00107972,0.00539428,0.00107972,1.07864e-06,0.003237,1.07864e-06,0.0086302,0.00107972,1.07864e-06,0.0258884,0.0657981,0.0291244,0.0819778,0.107865,0.0463826,0.181213,0.0550117,0.0431467,0.221122,0.0474613,0.0086302,0.00970884,0.0086302,0.00431564,0.00215836,0.003237,0.00431564,0.00755156,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,0.00215836,0.00215836,1.07864e-06,0.00215836,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,0.00107972,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,0.00107972,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06,1.07864e-06];
		this.outProb[0][4][2].P=[1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,0.0018991,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,0.0037963,0.0094879,1.8972e-06,0.0151795,0.0056935,1.8972e-06,0.0322543,1.8972e-06,0.0189739,0.176441,0.0910675,0.100553,0.252329,0.119525,0.0777871,0.0398432,0.0246655,0.0018991,0.0132823,0.0018991,1.8972e-06,0.0056935,0.0018991,0.0018991,0.0037963,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06,1.8972e-06];
		this.outProb[0][4][3].P=[1.49233e-06,0.00149382,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,0.00149382,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,0.00447848,1.49233e-06,0.00149382,0.00149382,0.00298615,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,0.00149382,0.00447848,1.49233e-06,1.49233e-06,0.0179095,0.00746314,0.0238788,0.079095,0.0761103,0.070141,0.404423,0.171619,0.0865566,0.0164171,0.00746314,1.49233e-06,0.00298615,0.00298615,0.00597081,0.00298615,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,0.00149382,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,0.00149382,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,0.00149382,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06,1.49233e-06];
		this.outProb[0][4][4].P=[1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,0.0210426,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,0.0210426,1.0516e-05,1.0516e-05,1.0516e-05,0.0105265,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,0.0105265,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,0.0210426,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,0.0315586,1.0516e-05,1.0516e-05,0.0105265,0.0105265,1.0516e-05,0.0946547,1.0516e-05,0.0105265,0.536328,0.0105265,0.0210426,0.0525906,0.0210426,0.0315586,1.0516e-05,1.0516e-05,1.0516e-05,0.0315586,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,0.0105265,1.0516e-05,1.0516e-05,0.0315586,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,0.0105265,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05,1.0516e-05];
		this.outProb[1][0][0].P=[4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,0.0044669,4.46243e-06,4.46243e-06,0.0044669,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,0.0133918,4.46243e-06,4.46243e-06,4.46243e-06,0.0044669,4.46243e-06,4.46243e-06,4.46243e-06,0.0044669,0.0133918,4.46243e-06,0.0044669,0.0267791,0.0133918,0.0178542,0.0133918,0.00892933,0.0223166,0.0937156,0.0312415,0.0223166,0.370386,0.00892933,0.0223166,0.0758658,0.0133918,4.46243e-06,0.0044669,0.0044669,0.00892933,0.0267791,4.46243e-06,4.46243e-06,0.0178542,4.46243e-06,0.0044669,0.0133918,0.0044669,0.00892933,4.46243e-06,4.46243e-06,4.46243e-06,0.0892531,4.46243e-06,4.46243e-06,4.46243e-06,0.0044669,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,0.0044669,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,4.46243e-06,0.0178542,4.46243e-06];
		this.outProb[1][0][1].P=[4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,0.000490424,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,0.000490424,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,0.000490424,4.89934e-07,0.000490424,0.00294009,0.000490424,4.89934e-07,0.00147029,0.00147029,0.000980357,0.00391996,0.00538976,0.00587969,0.0293965,0.018618,0.00832936,0.102397,0.0367455,0.0313562,0.121504,0.120524,0.0534033,0.214101,0.0778999,0.0313562,0.0289066,0.0298864,0.00196022,0.0132287,0.011269,0.00245016,0.00685956,0.00979916,0.00294009,0.00245016,4.89934e-07,0.000980357,0.00343002,0.000490424,4.89934e-07,0.00343002,0.00147029,0.00245016,0.000490424,4.89934e-07,4.89934e-07,0.00294009,0.000490424,4.89934e-07,4.89934e-07,4.89934e-07,0.000490424,0.000490424,4.89934e-07,0.000490424,0.000490424,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,4.89934e-07,0.000490424,4.89934e-07,0.000980357,0.000490424];
		this.outProb[1][0][2].P=[1.10608e-06,1.10608e-06,0.00110719,1.10608e-06,0.00110719,1.10608e-06,0.00110719,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,0.00110719,1.10608e-06,1.10608e-06,0.00110719,0.00331935,1.10608e-06,0.00221327,0.00110719,1.10608e-06,1.10608e-06,0.00110719,1.10608e-06,0.012168,1.10608e-06,1.10608e-06,0.00995582,0.0176984,0.0132741,0.0320775,0.0199106,0.0188045,0.102867,0.0165923,0.00774366,0.161489,0.0519868,0.0320775,0.101761,0.0575172,0.0342896,0.0199106,0.0320775,0.012168,0.0154862,0.0287592,0.00110719,0.0718963,0.0232288,0.00110719,0.0154862,0.0154862,0.00110719,0.0165923,1.10608e-06,1.10608e-06,0.00995582,1.10608e-06,0.0132741,1.10608e-06,1.10608e-06,1.10608e-06,0.00221327,1.10608e-06,0.00110719,0.00663758,1.10608e-06,1.10608e-06,0.00110719,1.10608e-06,0.00221327,0.00110719,0.00110719,1.10608e-06,0.00331935,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06,1.10608e-06];
		this.outProb[1][0][3].P=[1.02449e-06,0.0153684,0.00409899,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,0.00205001,0.00102552,1.02449e-06,1.02449e-06,0.00205001,1.02449e-06,0.00922146,0.00409899,1.02449e-06,0.0030745,0.00102552,0.00102552,0.00205001,0.0122949,1.02449e-06,0.00614798,0.0215154,0.00717247,0.0604461,0.0225399,0.00205001,0.0481522,0.074789,0.0307358,0.0778625,0.0881074,0.0348338,0.161871,0.0122949,0.0122949,0.0993768,0.0245888,0.00614798,0.0163929,0.00409899,0.0030745,0.0174174,0.00614798,0.00205001,0.0194664,0.0030745,1.02449e-06,0.0225399,0.00512349,0.00102552,0.0102459,0.0030745,0.00205001,0.0030745,1.02449e-06,0.00102552,0.00717247,0.00102552,0.0122949,1.02449e-06,0.00205001,1.02449e-06,0.00102552,1.02449e-06,1.02449e-06,0.0030745,0.00102552,1.02449e-06,0.00102552,1.02449e-06,1.02449e-06,0.00205001,1.02449e-06,0.00102552,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06,1.02449e-06];
		this.outProb[1][0][4].P=[0.00590566,0.0239497,0.00656181,3.28074e-07,0.00853025,0.0016407,0.00229685,0.00590566,0.00623373,0.00295299,0.00557759,0.00262492,0.00393722,0.0308393,0.00262492,0.0016407,0.0482272,0.00623373,0.00951447,0.0301831,0.0226374,0.0134514,0.0452745,0.0216532,0.0196848,0.220794,0.0209971,0.020669,0.0898926,0.03412,0.0351042,0.0508518,0.0272305,0.0127952,0.0843153,0.00328107,0.00295299,0.0091864,0.00524951,0.00229685,0.00328107,0.00131262,0.00196877,0.00131262,0.00098455,0.00098455,0.0167321,0.000656476,3.28074e-07,0.00131262,3.28074e-07,0.00295299,0.00131262,0.000656476,0.000656476,0.0016407,0.000656476,3.28074e-07,0.00524951,0.000328402,0.000656476,0.000656476,0.00196877,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,0.00459336,3.28074e-07,3.28074e-07,0.000328402,3.28074e-07,0.00131262,0.000328402,0.000328402,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07,3.28074e-07];
		this.outProb[1][1][0].P=[3.48664e-07,0.000349012,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,0.000349012,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,0.000349012,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,0.000349012,3.48664e-07,3.48664e-07,3.48664e-07,0.00244099,0.001395,0.00174367,0.00104634,0.00104634,0.00836828,0.0146442,0.000697676,0.0306828,0.0163875,0.0212688,0.0529972,0.124822,0.0725224,0.140512,0.147834,0.0658978,0.0613652,0.163175,0.00767095,0.0195255,0.0271961,0.00348699,0.00278966,0.00592763,0.001395,3.48664e-07,0.000349012,3.48664e-07,3.48664e-07,0.001395,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07,3.48664e-07];
		this.outProb[1][1][1].P=[7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,0.00746497,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,0.00746497,7.45751e-06,7.45751e-06,0.00746497,0.00746497,7.45751e-06,0.02238,7.45751e-06,0.00746497,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,0.00746497,0.0149225,0.02238,0.00746497,0.00746497,0.0149225,0.0149225,0.02238,7.45751e-06,0.02238,0.686098,0.02238,0.00746497,7.45751e-06,0.0149225,7.45751e-06,7.45751e-06,0.00746497,7.45751e-06,0.00746497,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,0.00746497,0.0447525,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,7.45751e-06,0.00746497];
		this.outProb[1][1][2].P=[1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,0.00107856,0.00215603,1.07748e-06,0.00107856,0.00323351,0.00215603,0.0280155,0.029093,0.0172407,0.0861994,0.160545,0.0603399,0.29092,0.107749,0.193947,0.00646595,0.00107856,1.07748e-06,0.00215603,1.07748e-06,0.00107856,1.07748e-06,0.00107856,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,0.00107856,1.07748e-06,1.07748e-06,1.07748e-06,0.00107856,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,0.00107856,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,0.00107856,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06];
		this.outProb[1][1][3].P=[2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,0.00484395,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,0.00242318,2.42076e-06,2.42076e-06,0.00242318,2.42076e-06,2.42076e-06,2.42076e-06,0.00242318,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,0.00726471,2.42076e-06,0.00242318,2.42076e-06,0.00484395,0.00484395,0.00726471,0.00484395,0.00242318,0.0363139,0.0193685,0.00726471,0.203346,0.108937,0.096833,0.285652,0.0581007,0.0726253,0.0193685,0.00726471,0.0193685,0.00242318,2.42076e-06,0.00484395,0.00242318,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,0.00484395,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,0.00242318,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,0.00242318,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06,2.42076e-06];
		this.outProb[1][1][4].P=[1.34936e-06,0.0121456,0.00135071,1.34936e-06,0.00270007,1.34936e-06,0.00135071,0.00674814,0.00404942,0.00674814,1.34936e-06,1.34936e-06,0.00135071,0.0121456,1.34936e-06,1.34936e-06,0.0229404,0.0310366,0.00674814,0.00674814,0.0121456,0.00404942,0.0188924,0.00539878,0.00270007,0.0458795,0.0134949,0.0242898,0.0283379,0.0269885,0.0134949,0.0391327,0.0499276,0.0607225,0.279319,0.0134949,0.0404821,0.156527,0.00674814,0.0121456,0.00539878,0.00404942,0.00674814,0.00270007,1.34936e-06,1.34936e-06,0.00270007,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,0.00135071,0.00270007,1.34936e-06,1.34936e-06,0.00270007,1.34936e-06,1.34936e-06,0.00135071,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06,1.34936e-06];
		this.outProb[1][2][0].P=[7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,0.000760585,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,0.00455971,7.59825e-07,0.00304006,0.00455971,0.00152041,0.025075,0.0425509,0.00228023,0.0759832,0.00455971,0.000760585,0.0151973,0.0258348,0.0319134,0.0828217,0.115494,0.0326732,0.0744636,0.149686,0.0258348,0.0395116,0.0782627,0.0189964,0.0547081,0.025075,0.0243152,0.0227955,0.00379988,7.59825e-07,0.00304006,0.00683918,7.59825e-07,7.59825e-07,0.000760585,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,0.00152041,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,7.59825e-07,0.000760585,7.59825e-07];
		this.outProb[1][2][1].P=[9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,0.00183562,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,0.000918269,0.00183562,9.17352e-07,9.17352e-07,9.17352e-07,0.000918269,9.17352e-07,0.000918269,0.00367033,0.00458767,0.0128439,0.124761,0.0697196,0.22567,0.0889841,0.155034,0.129348,0.0623808,0.0421991,0.0513726,0.00367033,0.00367033,0.00275298,0.00183562,0.000918269,0.00367033,9.17352e-07,0.000918269,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,9.17352e-07,0.00183562,9.17352e-07,9.17352e-07,9.17352e-07,0.00367033];
		this.outProb[1][2][2].P=[2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,0.0269862,2.69593e-05,2.69593e-05,2.69593e-05,0.0269862,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,0.0269862,2.69593e-05,0.0269862,2.69593e-05,2.69593e-05,0.0269862,0.0269862,0.0269862,0.727927,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,0.0269862,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,0.0539455,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05,2.69593e-05];
		this.outProb[1][2][3].P=[2.88107e-06,0.00288395,2.88107e-06,2.88107e-06,0.00288395,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,0.00288395,2.88107e-06,2.88107e-06,2.88107e-06,0.00288395,2.88107e-06,2.88107e-06,0.00288395,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,0.00288395,0.00576503,0.00576503,0.0547433,0.12677,0.103721,0.417758,0.0547433,0.198797,0.00576503,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,0.00576503,2.88107e-06,0.00288395,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06,2.88107e-06];
		this.outProb[1][2][4].P=[2.47468e-06,2.47468e-06,0.00247715,2.47468e-06,2.47468e-06,2.47468e-06,0.00247715,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,0.00990118,2.47468e-06,2.47468e-06,0.0197999,2.47468e-06,0.0074265,0.00247715,2.47468e-06,0.00990118,0.0148505,2.47468e-06,2.47468e-06,0.034648,0.0123759,0.0148505,0.00495183,0.00990118,0.00247715,0.0074265,0.0197999,0.00990118,0.168281,0.00495183,0.0148505,0.106414,0.0371226,0.155907,0.13611,0.042072,0.0915655,0.0197999,2.47468e-06,0.00495183,0.00495183,2.47468e-06,0.0123759,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,0.00495183,2.47468e-06,0.00247715,2.47468e-06,0.00495183,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,0.00247715,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06,2.47468e-06];
		this.outProb[1][3][0].P=[1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,0.00792637,1.32084e-06,1.32084e-06,0.00528469,0.00396385,0.00132216,0.0118889,0.00528469,0.0145306,0.0211348,0.00132216,0.0250973,0.00132216,0.00132216,0.00660553,0.0250973,0.00528469,0.00924721,0.00660553,0.00792637,0.00660553,0.110952,0.00132216,0.0211348,0.145294,0.0488725,0.0554767,0.0871769,0.0383057,0.0330224,0.0317015,0.00396385,0.00132216,0.228507,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,0.00396385,0.002643,1.32084e-06,0.002643,0.00132216,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,1.32084e-06,0.0145306,1.32084e-06];
		this.outProb[1][3][1].P=[1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,0.00232649,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,0.00232649,0.00116383,1.16266e-06,0.00232649,0.00465182,0.00348916,0.0372064,0.0860384,0.0674357,0.237185,0.103478,0.139521,0.203468,0.00697715,0.0290678,0.0569717,0.00232649,0.00232649,0.00348916,0.00116383,0.00116383,1.16266e-06,1.16266e-06,1.16266e-06,0.00116383,1.16266e-06,1.16266e-06,1.16266e-06,0.00232649,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,0.00116383,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06,0.00116383,1.16266e-06,1.16266e-06,1.16266e-06,1.16266e-06];
		this.outProb[1][3][2].P=[2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,0.00251449,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,0.00502646,2.51198e-06,0.00251449,0.00502646,0.298928,0.0728498,0.296416,0.123089,0.0753618,0.0477301,0.0150744,0.0125624,0.0376821,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,0.00251449,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,0.00251449,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06,2.51198e-06];
		this.outProb[1][3][3].P=[5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,0.058562,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,0.058562,0.058562,5.85035e-05,5.85035e-05,0.058562,0.058562,5.85035e-05,0.585093,5.85035e-05,0.058562,5.85035e-05,5.85035e-05,0.058562,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05,5.85035e-05];
		this.outProb[1][3][4].P=[0.00826542,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,0.00413477,0.00413477,0.00413477,0.00826542,4.13064e-06,4.13064e-06,4.13064e-06,0.00413477,0.00413477,4.13064e-06,4.13064e-06,4.13064e-06,0.0123961,0.0165267,0.00826542,0.0330493,0.00413477,0.00413477,0.0165267,0.00413477,4.13064e-06,4.13064e-06,0.024788,0.0165267,0.0495719,0.00413477,0.00826542,0.0619638,4.13064e-06,0.0743557,0.024788,0.0330493,0.0578331,0.351109,0.0330493,0.0784864,0.00826542,4.13064e-06,0.00413477,0.00826542,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,0.00826542,4.13064e-06,4.13064e-06,0.00413477,0.00413477,4.13064e-06,0.00413477,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,0.00413477,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06,4.13064e-06];
		this.outProb[1][4][0].P=[4.75943e-07,0.000476419,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,4.75943e-07,0.000952361,4.75943e-07,4.75943e-07,4.75943e-07,0.000952361,0.000952361,0.000476419,0.000952361,4.75943e-07,0.0014283,0.000476419,4.75943e-07,0.000476419,0.0014283,0.0171344,4.75943e-07,0.00238019,0.0628249,0.0157066,0.0157066,0.0361721,0.012375,0.0128509,0.0547339,0.0047599,0.0014283,0.664893,0.00190425,0.00238019,0.00380802,0.00761556,0.00761556,0.0218938,0.00333208,0.012375,0.0047599,4.75943e-07,4.75943e-07,0.00761556,0.000476419,0.000952361,4.75943e-07,4.75943e-07,0.00761556,4.75943e-07,4.75943e-07,4.75943e-07,0.0047599,4.75943e-07,4.75943e-07,0.00190425,0.0014283];
		this.outProb[1][4][1].P=[1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,0.00208635,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,1.04265e-06,0.00104369,1.04265e-06,0.00104369,1.04265e-06,0.003129,0.00104369,0.00208635,0.003129,0.00417165,0.00417165,0.0145982,0.0125129,0.175167,0.0229394,0.0417071,0.3691,0.0615175,0.0667307,0.0573469,0.0385792,0.00729959,0.0218967,0.00729959,1.04265e-06,0.0281526,0.00208635,1.04265e-06,0.00417165,0.00625695,0.00208635,0.00625695,0.00417165,0.00104369,0.003129,1.04265e-06,1.04265e-06,0.0114702,1.04265e-06,1.04265e-06,0.003129,0.00104369,0.00104369,1.04265e-06,1.04265e-06,1.04265e-06,0.003129,0.00104369,1.04265e-06,0.00104369,0.00208635];
		this.outProb[1][4][2].P=[1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,0.00107856,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,0.00107856,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,0.00538847,1.07748e-06,0.00538847,0.0592624,0.0635723,0.20149,0.16701,0.0754246,0.148693,0.0150858,0.0226281,0.156235,0.0204732,0.00646595,0.0086209,0.00431099,0.00538847,0.00538847,1.07748e-06,1.07748e-06,0.0140083,1.07748e-06,1.07748e-06,0.00215603,0.00107856,1.07748e-06,0.00107856,0.00323351,0.00215603,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,0.00107856,1.07748e-06,1.07748e-06,0.00107856,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,1.07748e-06,0.00107856,1.07748e-06];
		this.outProb[1][4][3].P=[1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,0.00194712,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,0.00194712,1.94517e-06,1.94517e-06,0.00583747,1.94517e-06,0.00389229,0.00583747,0.00194712,0.00972781,0.0486313,0.0291795,0.173122,0.068083,0.0914251,0.136164,0.0875347,0.0350151,0.0194537,0.00194712,0.00583747,0.0641927,0.0252892,0.00972781,0.0136182,0.00583747,0.00583747,0.00972781,1.94517e-06,1.94517e-06,0.0603023,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,0.00778264,0.00194712,0.00194712,0.00194712,1.94517e-06,1.94517e-06,0.0505765,0.00389229,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06,0.00972781,1.94517e-06,1.94517e-06,1.94517e-06,1.94517e-06];
		this.outProb[1][4][4].P=[4.5852e-06,0.00458979,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,0.00458979,0.0596122,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,0.00917497,4.5852e-06,4.5852e-06,0.055027,0.00458979,4.5852e-06,4.5852e-06,4.5852e-06,0.00458979,4.5852e-06,0.00917497,4.5852e-06,0.0412714,4.5852e-06,4.5852e-06,0.0183454,0.00458979,0.00458979,0.00917497,0.00458979,0.0137602,0.0596122,0.0183454,4.5852e-06,0.298043,0.00458979,0.00917497,0.00917497,0.00458979,4.5852e-06,4.5852e-06,0.00458979,4.5852e-06,0.0871233,0.00917497,4.5852e-06,0.0504418,0.0137602,0.0137602,0.00917497,4.5852e-06,0.00458979,0.00458979,4.5852e-06,0.00917497,0.0779529,4.5852e-06,4.5852e-06,0.00458979,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,0.00917497,4.5852e-06,4.5852e-06,0.00458979,0.0183454,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,4.5852e-06,0.0137602,4.5852e-06,4.5852e-06,0.00917497,4.5852e-06,0.00458979,4.5852e-06,4.5852e-06];

		for(var h=0;h<2;h+=1){
			this.iniProb[h].Normalize();
			for(var ip=0;ip<5;ip+=1){
				this.trProb[h][ip].Normalize();
				for(var i=0;i<5;i+=1){
					this.outProb[h][ip][i].Normalize();
				}//endfor i
			}//endfor ip
		}//endfor h
	}//end Init

	Viterbi(hand){//hand=0:RH/1:LH
		var pos=[];
		for(var i=0,len=this.fin.length;i<len;i+=1){
			if(this.fin[i].channel==hand){pos.push(i);}
		}//endfor i

		var LP=new Array(5);
		var amax=new Array(pos.length);

		//Initialization
		for(var k=0;k<5;k+=1){
			LP[k]=this.iniProb[hand].LP[k];
		}//endfor k

		//Forward update
		for(var n=1,len=pos.length;n<len;n+=1){
			amax[n]=new Array(5);
			var preLP=LP.concat();
			var logP;
			var keyInt=SubtrKeyPos(new KeyPos(this.fin[pos[n]].pitch),new KeyPos(this.fin[pos[n-1]].pitch));
			if(keyInt.x<-this.widthX){keyInt.x=-this.widthX;}
			if(keyInt.x>this.widthX){keyInt.x=this.widthX;}
			var shortTime=Math.abs(this.fin[pos[n]].ontime-this.fin[pos[n-1]].ontime)<0.03;
			var delPitch=this.fin[pos[n]].pitch-this.fin[pos[n-1]].pitch;
			for(var k=0;k<5;k+=1){
				LP[k]=preLP[0]+this.trProb[hand][0].LP[k]+this.w1*this.outProb[hand][0][k].LP[3*(keyInt.x+this.widthX)+keyInt.y+1]+((shortTime&&((hand==0&&(k)*delPitch<0)||(hand==1&&(k)*delPitch>0)))? this.shortTimeCost:0);
				amax[n][k]=0;
				for(var kp=1;kp<5;kp+=1){
					logP=preLP[kp]+this.trProb[hand][kp].LP[k]+this.w1*this.outProb[hand][kp][k].LP[3*(keyInt.x+this.widthX)+keyInt.y+1]+((shortTime&&((hand==0&&(k-kp)*delPitch<0)||(hand==1&&(k-kp)*delPitch>0)))? this.shortTimeCost:0);
					if(logP>LP[k]){
						LP[k]=logP;
						amax[n][k]=kp;
					}//endif
				}//endfor kp
			}//endfor k

		}//endfor n

		var optPath=new Array(pos.length);
		optPath[pos.length-1]=0;
		for(var k=1;k<5;k+=1){
			if(LP[k]>LP[optPath[pos.length-1]]){optPath[pos.length-1]=k;}
		}//endfor k
		for(var n=pos.length-2;n>=0;n-=1){
			optPath[n]=amax[n+1][optPath[n+1]];
		}//endfor n

		for(var n=0,len=pos.length;n<len;n+=1){
			this.fin[pos[n]].fingerNum=((hand==0)? "":"-")+String(optPath[n]+1);
			this.fin[pos[n]].fingerRep=String(optPath[n]+1);
		}//endfor n

	}//end Viterbi

	ViterbiTwoHands(){
		this.Viterbi(0);
		this.Viterbi(1);
	}//end ViterbiTwoHands

}//endclass FHMM1


class HandSepModel{

	constructor(){
		this.Lprob=[];
		this.uniLprob=[];
		this.LRLprob=[];
		this.fin=[];//fingering data
		this.Init();
	}//end constructor

	Init(){
		this.Lprob=new Array(2);
		this.uniLprob=new Array(2);
		this.LRLprob=new Array(2);
		this.Lprob[0]=[-10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -8.92457, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -8.23142, -10.0232, -9.33003, -9.33003, -10.0232, -8.92457, -8.92457, -9.33003, -8.63688, -8.92457, -8.41374, -10.0232, -7.94374, -8.92457, -7.82596, -8.23142, -7.02745, -7.94374, -7.45823, -7.13281, -7.07874, -6.30961, -5.94564, -6.58919, -3.60319, -4.72988, -4.39916, -3.87258, -4.27379, -3.70601, -4.02177, -3.3311, -3.16567, -2.76688, -2.14011, -2.42528, -3.31632, -2.38498, -2.40296, -2.76971, -3.12346, -3.13359, -4.12055, -3.74842, -3.9877, -3.80657, -4.41371, -4.77616, -3.57905, -7.07874, -6.72734, -6.35962, -6.72734, -7.38412, -9.33003, -7.94374, -7.45823, -7.94374, -8.63688, -9.33003, -7.62529, -10.0232, -8.63688, -9.33003, -10.0232, -8.63688, -10.0232, -8.92457, -8.92457, -8.92457, -7.94374, -10.0232, -8.92457, -10.0232, -9.33003, -10.0232, -8.92457, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232, -10.0232];
		this.Lprob[1]=[-9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.08217, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.08217, -8.6767, -9.77531, -8.6767, -9.08217, -8.38902, -9.77531, -8.6767, -9.77531, -8.16587, -8.6767, -9.77531, -7.57809, -8.6767, -7.69587, -8.38902, -9.08217, -7.69587, -9.77531, -6.88494, -7.98355, -6.88494, -7.29041, -6.68427, -6.30958, -7.06726, -5.96865, -6.06174, -5.73226, -5.28668, -6.01411, -3.34398, -5.00463, -4.36367, -4.20316, -4.1441, -3.18776, -4.01957, -3.41921, -3.22566, -2.77316, -2.33224, -2.7339, -3.55871, -2.66953, -2.38021, -2.5057, -2.95858, -2.96738, -4.26998, -3.47453, -4.26998, -4.24192, -4.67545, -6.13773, -3.22996, -6.68427, -5.69777, -5.57062, -6.08643, -6.24895, -7.13626, -6.03764, -7.13626, -7.69587, -6.9421, -9.08217, -6.51721, -9.77531, -7.57809, -8.38902, -7.98355, -8.6767, -8.38902, -8.38902, -8.6767, -9.77531, -8.6767, -9.77531, -9.08217, -9.77531, -9.77531, -9.77531, -9.08217, -9.77531, -9.08217, -9.08217, -9.77531, -9.77531, -8.6767, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.08217, -9.08217, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531, -9.77531];
		this.uniLprob[0]=[-10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -8.91946, -8.91946, -8.91946, -8.07215, -8.07215, -8.22631, -7.37901, -7.82084, -6.49171, -6.3545, -6.55233, -6.52155, -6.75996, -5.55216, -5.39309, -5.57541, -4.70486, -4.52913, -4.28149, -4.82511, -3.51678, -3.83391, -3.97306, -3.77002, -3.86534, -3.18073, -3.73393, -3.51228, -3.32971, -3.01773, -2.90086, -3.20462, -2.96621, -2.92882, -3.19587, -2.99253, -3.34857, -3.01318, -3.41277, -3.67594, -3.58191, -3.51828, -3.69013, -4.0068, -4.28473, -4.02161, -4.09114, -4.67573, -4.62444, -4.66621, -5.4331, -5.4129, -6.06682, -5.37367, -6.32919, -5.79856, -6.88257, -6.49171, -6.30449, -7.45312, -6.79919, -7.12769, -8.40863, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181, -10.0181];
		this.uniLprob[1]=[-9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -8.67009, -9.7687, -8.15926, -8.3824, -8.15926, -8.15926, -7.82279, -6.72418, -5.98451, -6.30296, -6.99611, -5.32605, -5.30279, -5.46463, -5.11474, -4.92451, -4.91667, -5.67435, -3.98795, -4.4754, -4.44083, -3.99726, -3.91362, -3.5581, -4.20418, -3.33255, -3.17292, -3.52259, -3.31193, -3.55409, -2.79142, -3.26891, -3.30723, -3.07166, -3.00712, -2.9049, -3.12361, -3.15263, -3.01409, -3.39538, -3.34059, -3.5501, -3.2979, -3.81805, -4.17399, -4.37507, -4.49058, -4.59255, -5.04131, -5.62556, -5.25784, -6.03103, -6.27219, -6.54982, -6.30296, -7.46611, -7.12964, -7.97694, -7.97694, -8.15926, -8.3824, -8.67009, -8.67009, -8.67009, -9.07555, -8.67009, -9.7687, -9.07555, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687, -9.7687];
		this.LRLprob[0]=-0.5755099333;//log(0.562418)
		this.LRLprob[1]=-0.82649116217;//log(0.437582)
	}//end Init

	SeparateHands(){

		var len=this.fin.length;
		var dp_c=15;
		var handPartPreference=new Array(len);//HandPartPreference[m][0]=1 if m-th note is likely to be in the right-hand-part
		for(var i=0;i<len;i+=1){handPartPreference[i]=[0,0];}
		var pitch=[];
		for(var n=0;n<len;n+=1){
			var p_cur=this.fin[n].pitch;
			var p_max=p_cur;
			var p_min=p_cur;
			pitch.push(p_cur);
			for(var m=0;m<len;m+=1){
				if(this.fin[m].offtime < this.fin[n].ontime){continue;}
				if(this.fin[m].ontime  > this.fin[n].offtime){break;}
				if(this.fin[m].pitch>p_max){p_max=this.fin[m].pitch;}
				if(this.fin[m].pitch<p_min){p_min=this.fin[m].pitch;}
			}//endfor m
			if(p_cur>p_min+dp_c){handPartPreference[n][0]=1;}//likely to be in the right-hand-part
			if(p_cur<p_max-dp_c){handPartPreference[n][1]=1;}//likely to be in the left-hand-part
		}//endfor n

		if(pitch.length<2){return;}

		var Nh=50;
		var LP=[];
		var v=new Array(10);
		for(var i=0;i<2*Nh;i+=1){LP.push(-1000);}
		var amax=new Array(len);
		LP[0]=this.uniLprob[0][pitch[0]];
		LP[1]=this.uniLprob[1][pitch[1]];
		for(var n=1;n<len;n+=1){
			var logP;
			var preLP=LP.concat();
			amax[n]=new Array(2*Nh);
			for(var i=0;i<2*Nh;i+=1){
				LP[i]=preLP[i]-10000;
				amax[n][i]=i;
				for(var j=0;j<2*Nh;j+=1){
					if(j%2==i%2 && Math.floor(j/2)==Math.floor(i/2)-1){
						logP=preLP[j]+this.LRLprob[i%2]+this.Lprob[i%2][pitch[n]-pitch[n-1]+128];
						if(logP>LP[i]){LP[i]=logP; amax[n][i]=j;}
					}//endif
					if(j%2!=i%2 && Math.floor(i/2)==0){
						if(n-2-Math.floor(j/2)>=0){
							logP=preLP[j]+this.LRLprob[i%2]+this.Lprob[i%2][pitch[n]-pitch[n-2-Math.floor(j/2)]+128];
						}else{
							logP=preLP[j]+this.LRLprob[i%2]+this.Lprob[i%2][pitch[n]-((j%2==0)? 53:71)+128];
						}//endif
						if(logP>LP[i]){LP[i]=logP; amax[n][i]=j;}
					}//endif
				}//endfor j
				if(i%2==0){
					v[1]=53;
					if(n-1-Math.floor(i/2)>=0){v[1]=pitch[n-1-Math.floor(i/2)];}
					LP[i]+=((v[1]<pitch[n])? 0:-4.605)+((handPartPreference[n][0]>0)? -0.0202027:-0.693147)+((handPartPreference[n][1]>0)? -3.912023:-0.693147);
				}else{
					v[0]=71;
					if(n-1-Math.floor(i/2)>=0){v[0]=pitch[n-1-Math.floor(i/2)];}
					LP[i]+=((v[0]>pitch[n])? 0:-4.605)+((handPartPreference[n][0]>0)? -3.912023:-0.693147)+((handPartPreference[n][1]>0)? -0.0202027:-0.693147);
				}//endif
			}//endfor i
		}//endfor n

		var estStates=new Array(len);
		estStates[len-1]=0;
		for(var i=0;i<2*Nh;i+=1){
			if(LP[i]>LP[estStates[len-1]]){estStates[len-1]=i;}
		}//endfor i
		for(var n=len-2;n>=0;n-=1){
			estStates[n]=amax[n+1][estStates[n+1]];
		}//endfor n
		for(var n=0;n<len;n+=1){
			this.fin[n].channel=estStates[n]%2;
			this.fin[n].fingerNum=((estStates[n]%2==0)? "":"-")+this.fin[n].fingerRep;
		}//endfor n

	}//end SeparateHands

}//endclass HandSepModel





